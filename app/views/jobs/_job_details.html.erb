<div id="<%= dom_id job %>" class='card w-full md:w-86 lg:w-1/2'>
  <%= render 'header', job: job %>

  <% if action_name == 'index' && controller_name == 'jobs' %>
    <%= link_to job_notes_path(job), class: "h-32 bg-gray-100 text-sm py-3 px-2 tracking-tight block text-truncate overflow-hidden" do %>
      <%- if job.notes.last.present? %>
        <div class="float-left pr-1 pb-1 pt-1">
          <svg fill="none" stroke="currentColor" stroke-width="1.5" class="w-8 h-8" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9z"/></svg>
        </div>
        <div class="">
          <span class='font-medium pr-2 text-black'><%= job.notes.last.created_at.strftime("%b %d '%Y") %></span>
          <span class='text-black max-w-prose'><%= truncate(job.notes.last.content, length: 130)%></span>
        </div>
      <%- end %>
    <% end %>
  <% end %>


  <div class="flex flex-col-2 gap-5 mb-10">
    <div class="w-2/3">
      <% if job.url.present? %>
        <div class='mb-5'>
          <h2 class="">
            <%= link_to job.url, target: '_blank', class: "" do %>
              <div class='inline-block'>Listing</div>
              <div class='inline-block'>
                <svg fill="none" stroke="currentColor" stroke-width="1.5" class="w-3 h-3" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="m4.5 19.5 15-15m0 0H8.25m11.25 0v11.25"/></svg>
              </div>
            <% end %>
          </h2>
        </div>
      <% end %>
      <% if job.primary_contact_name.present? %>
        <div class='mb-2'>
          <h2 class="font-light text-sm">Primary contact name</h2>
          <div class="font-bold"><%= job.primary_contact_name %></div>
        </div>
      <% end %>
      <% if job.primary_contact_email.present? %>
        <div class='mb-2'>
          <h2 class="font-light text-sm">Primary contact email</h2>
          <div class="font-bold"><%= mail_to job.primary_contact_email %></div>
        </div>
      <% end %>
      <% if job.primary_contact_phone.present? %>
        <div class='mb-2'>
          <h2 class="font-light text-sm">Primary contact phone</h2>
          <div class="font-bold"><%= link_to job.primary_contact_phone, "tel:#{job.primary_contact_phone}" %></div>
        </div>
      <% end %>
    </div>

    <div>
      <div class='mb-2'>
        <h2 class="font-light text-sm">Mode</h2>
        <div class="font-bold"><%= job.mode&.capitalize %></div>
      </div>
      <% if job.salary.present? %>
        <div class='mb-2'>
          <h2 class="font-light text-sm">Salary</h2>
          <div class="font-bold"><%= job.salary %></div>
        </div>
      <% end %>
      <% if job.source.present? %>
        <div class='mb-2'>
          <h2 class="font-light text-sm">Source</h2>
          <div class="font-bold"><%= job.source&.name %></div>
        </div>
      <% end %>
    </div>
  </div>


    <div class='mb-12 border-t-2 pt-3'>
      <h2 class="font-bold mb-5">Notes</h2>
      <%= link_to 'New note', new_job_note_path(job), class: 'button block mb-5 max-w-max' %>

      <%= render @notes %>

      <%- if @notes.count > 3 %>
        <%= link_to 'More notes', job_notes_path(job), class: 'button' %>
      <% end %>
    </div>

    <% if job.description.present? %>
      <div class='mb-12 border-t-2 pt-3'>
        <h2 class="font-bold mb-5">Description</h2>
        <%= job.description %>
      </div>
    <% end %>


  <div class='mt-3 flex justify-end'>
    <%= render 'actions', job: job %>
  </div>
</div>
